\begin{abstract}
Network measurement is now a basic building block that supports network management applications to identify real-time events by measuring both large and small flows. However, existing techniques face the trade-off between high accuracy and resource efficiency: sketch-based techniques enjoy high accuracy and low resource consumption when measuring large flows but drop accuracy for small flows; in-band network telemetry (INT) measures every flow but brings high resource consumption.

In this paper, we present \sysname, a framework that utilizes sketches and INT to measure large and small flows, respectively, simultaneously achieving high accuracy and resource efficiency. Unlike existing studies, our co-design is driven by two theoretical optimizations: (1) \sysname adopts the near-optimal Lagrangian relaxation to solve the NP-hard selection of measurement points to deploy sketches and INT even when the routing information is unknown. (2) \sysname estimates the worst-case rates of collecting measurement data. Its estimates support reinforcement learning to select paths without network congestions. We realize \sysname on $32\times400$\,Gbps Tofino2 switches. With large-scale real-world topologies and eight network management applications, \sysname provides up to $5\times$ accuracy and reduces resource consumption by $5\times$ when compared with five types of existing techniques. 
\end{abstract}

%Sketches naturally produce accurate results for large flows with resource efficiency. Next, \sysname uses INT to transfer the data of small flows to the control plane. As small flows only have a few packets, it limits INT's resource consumption. 
